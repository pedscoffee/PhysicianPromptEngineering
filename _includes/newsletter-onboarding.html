<!-- Newsletter Invitation Modal -->
<div class="onboarding-overlay" id="newsletterOnboarding">
    <div class="onboarding-modal">
        <button class="onboarding-close" onclick="closeOnboarding('newsletterOnboarding')" aria-label="Close">&times;</button>

        <div class="onboarding-content">
            <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" style="width: 3rem; height: 3rem; color: var(--color-primary);">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M21.75 6.75v10.5a2.25 2.25 0 01-2.25 2.25h-15a2.25 2.25 0 01-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0019.5 4.5h-15a2.25 2.25 0 00-2.25 2.25m19.5 0v.243a2.25 2.25 0 01-1.07 1.916l-7.5 4.615a2.25 2.25 0 01-2.36 0L3.32 8.91a2.25 2.25 0 01-1.07-1.916V6.75" />
                </svg>
                <h2 style="margin: 0;">Stay in the Loop</h2>
            </div>
            <p>
                Join <strong>1,000+ physicians</strong> who get weekly updates on:
            </p>

            <ul style="font-size: 1.05rem; margin: 1.5rem 0;">
                <li>New prompts and documentation techniques</li>
                <li>Time-saving clinical tools and updates</li>
                <li>Real-world AI implementation strategies</li>
                <li>Early access to new features</li>
            </ul>

            <div style="background: #f8f9fa; padding: 1.5rem; border-radius: 12px; border-left: 4px solid var(--color-primary); margin: 1.5rem 0;">
                <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" style="width: 1.5rem; height: 1.5rem; color: var(--color-primary);">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75m-3-7.036A11.959 11.959 0 013.598 6 11.99 11.99 0 003 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285z" />
                    </svg>
                    <p style="margin: 0; font-weight: 600; color: var(--color-text);">
                        We respect your inbox
                    </p>
                </div>
                <p style="margin: 0; font-size: 0.95rem;">
                    One email per week, max. Unsubscribe anytime. No spam, ever.
                </p>
            </div>

            <!-- Embedded Substack Form -->
            <div class="embed-container" style="margin: 2rem 0;">
                <iframe src="https://pedscoffee.substack.com/embed" width="100%" height="320" style="border:1px solid #EEE; background:white; border-radius: 8px;" frameborder="0" scrolling="no"></iframe>
            </div>

            <div class="onboarding-actions">
                <button class="onboarding-btn onboarding-btn-text" onclick="completeOnboarding('newsletterOnboarding')">
                    Maybe later
                </button>
            </div>

            <p style="text-align: center; font-size: 0.85rem; color: #6c757d; margin-top: 1rem;">
                By subscribing, you agree to receive emails from Physician Prompt Engineering.
            </p>
        </div>
    </div>
</div>

<script>
// Initialize newsletter onboarding with multiple triggers
document.addEventListener('DOMContentLoaded', function() {
    OnboardingSystem.init('newsletterOnboarding', {
        totalSteps: 1,
        localStorageKey: 'ppe_newsletter_prompt_shown',
        showOnce: true, // Only show once per user
        delay: 0, // No initial delay
        triggers: [
            // Show after user scrolls 60% down the page
            { type: 'scroll', percentage: 60 },
            // OR show when user tries to leave the page (exit intent)
            { type: 'exit-intent' }
        ],
        onComplete: function() {
            console.log('Newsletter prompt dismissed');
        }
    });

    // Also set up manual trigger for newsletter links
    document.querySelectorAll('a[href*="newsletter"], .newsletter-trigger').forEach(link => {
        link.addEventListener('click', function(e) {
            e.preventDefault();
            OnboardingSystem.trigger('newsletterOnboarding');
        });
    });
});
</script>
