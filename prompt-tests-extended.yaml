# =========================================================
# EXTENDED PROMPT GENERATOR VERIFICATION SUITE
# Covers PatternAnalyzer + PromptGenerator layers
# =========================================================

# ---------------------------------------------------------
# 1. Basic Structure Recognition
# ---------------------------------------------------------
- name: "Bold Problems - Simple Bullets"
  input: |
    **Asthma**
        - Flovent 44 BID
        - RTC 3mo
  expected:
    structure.problemFormat: bold
    plan.primary: simple_bullets

- name: "ALL CAPS Problem Headings"
  input: |
    ASTHMA
        - Flovent 44 BID
        - Albuterol PRN
  expected:
    structure.problemFormat: caps

- name: "Capitalized With Colon"
  input: |
    Asthma:
        - Continue Flovent
  expected:
    structure.problemFormat: capitalized-colon

- name: "Capitalized Followed by Bullets"
  input: |
    Asthma
        - Continue Flovent
        - RTC 3mo
  expected:
    structure.problemFormat: capitalized

# ---------------------------------------------------------
# 2. Assessment Format Detection
# ---------------------------------------------------------
- name: "Narrative Assessment"
  input: |
    **Asthma**
    Patient with worsening cough and nighttime symptoms.
    Environmental triggers suspected.
        - Start Flovent 44 BID
        - RTC 1mo
  expected:
    assessment.primary: narrative

- name: "One-Liner Assessment"
  input: |
    **Asthma**
    Mild intermittent, controlled.
        - Continue Flovent
  expected:
    assessment.primary: oneliner-phrase

- name: "Minimal Assessment"
  input: |
    **Asthma**
        - Continue Flovent
        - RTC 3mo
  expected:
    assessment.primary: minimal

- name: "Assessment Wrap (Single Long Line)"
  input: |
    **Asthma**
    Child with persistent cough likely related to allergic rhinitis and mild intermittent asthma; plan to step up therapy.
        - Start Flovent
        - Allergy control measures
  expected:
    assessment.primary: narrative

# ---------------------------------------------------------
# 3. Plan Detection Edge Cases
# ---------------------------------------------------------
- name: "Narrative Plan Without Bullets"
  input: |
    **Asthma**
    Mild persistent. Will start Flovent 44 BID and follow up in 3mo.
  expected:
    plan.primary: narrative

- name: "Hybrid Plan (Sentence + Bullets)"
  input: |
    **Asthma**
    Child with poor control. Plan to step up therapy.
        - Start Flovent
        - RTC 1mo
  expected:
    plan.primary: hybrid

- name: "Categorized Plan With Bold Subheads"
  input: |
    **Asthma**
    **Diagnostics:**
        - PFTs ordered
    **Therapeutics:**
        - Flovent started
  expected:
    plan.primary: categorized

- name: "Categorized Plan With Bulleted Subheads"
  input: |
    **Asthma**
        - Diagnostics:
            - PFTs
        - Follow-up:
            - RTC 1mo
  expected:
    plan.primary: categorized

# ---------------------------------------------------------
# 4. Brevity and Word Count
# ---------------------------------------------------------
- name: "Terse Bullets"
  input: |
    **Asthma**
        - Flovent BID
        - RTC 3mo
  expected:
    brevity.level: terse

- name: "Verbose Bullets"
  input: |
    **Asthma**
        - Initiated Flovent 44 BID given frequent night symptoms despite albuterol use.
        - Follow-up planned in one month for reassessment of control.
  expected:
    brevity.level: verbose

# ---------------------------------------------------------
# 5. Justification Detection
# ---------------------------------------------------------
- name: "Brief Justification"
  input: |
    **Asthma**
        - Start Flovent for improved control
  expected:
    justification.level: brief

- name: "Detailed Justification"
  input: |
    **Asthma**
        - Start Flovent 44 BID per NHLBI guideline step 2 criteria
  expected:
    justification.level: detailed

# ---------------------------------------------------------
# 6. Contingency Language
# ---------------------------------------------------------
- name: "Simple Contingency"
  input: |
    **Fever**
        - Tylenol PRN
        - Return if worsening
  expected:
    contingency.level: simple

- name: "Detailed Contingency"
  input: |
    **Asthma**
        - If no improvement, escalate to Symbicort
        - If worsening, consider oral steroid
  expected:
    contingency.level: detailed

# ---------------------------------------------------------
# 7. Voice and Tone
# ---------------------------------------------------------
- name: "First Person"
  input: |
    **Asthma**
        - I started Flovent 44 BID
  expected:
    voice.voice: first_person

- name: "Third Person"
  input: |
    **Asthma**
        - Will start Flovent 44 BID
  expected:
    voice.voice: third_person

- name: "Passive Voice"
  input: |
    **Asthma**
        - Flovent was started
  expected:
    voice.voice: passive

- name: "Patient-Centric Voice"
  input: |
    **Asthma**
        - Patient prefers to continue current regimen
  expected:
    voice.voice: patient_centric

# ---------------------------------------------------------
# 8. Abbreviation Density
# ---------------------------------------------------------
- name: "Low Abbreviation Density"
  input: |
    **Asthma**
        - Start Flovent twice daily
  expected:
    abbreviations.level: low

- name: "High Abbreviation Density"
  input: |
    **Asthma**
        - Flovent BID, albuterol PRN, RTC 1mo
  expected:
    abbreviations.level: high

# ---------------------------------------------------------
# 9. Consistency and Mixed Formats
# ---------------------------------------------------------
- name: "Mixed Assessment Formats"
  input: |
    **Asthma**
    Mild intermittent, controlled.
        - Continue Flovent

    **Otitis Media**
        - Amoxicillin BID x10d
  expected:
    consistency.isConsistent: false

- name: "Consistent Minimal Style"
  input: |
    **Asthma**
        - Continue Flovent
    **Eczema**
        - Topical steroid PRN
  expected:
    consistency.isConsistent: true

# ---------------------------------------------------------
# 10. Error Handling
# ---------------------------------------------------------
- name: "No Problem Detected"
  input: |
    Random unformatted text without bold or caps headings.
  expected_error: "Could not detect any problems"

- name: "Empty Content After Problems"
  input: |
    **Asthma**
  expected_error: "Examples need content after problem names"

# ---------------------------------------------------------
# 11. Output Validation (PromptGenerator)
# ---------------------------------------------------------
- name: "Output Includes Section Headers"
  input: |
    **Asthma**
        - Flovent BID
        - RTC 3mo
  output_should_contain:
    - "## Output Structure"
    - "## Formatting Rules"
    - "## Few-Shot Examples"

- name: "Output Includes Problem Style Rule"
  input: |
    **Asthma**
        - Flovent BID
  output_should_contain:
    - "Bold all problem/diagnosis names"

- name: "Output Includes Brevity Rule"
  input: |
    **Asthma**
        - Flovent BID
  output_should_contain:
    - "Keep bullets extremely brief"

- name: "Output Includes Contingency Rule"
  input: |
    **Fever**
        - Return if worsening
  output_should_contain:
    - "Include simple return precautions"